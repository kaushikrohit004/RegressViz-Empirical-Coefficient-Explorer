<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Efficient Visualization of Regression Coefficients for LM, GLM, and GLMNET Objects â€¢ RegrCoeffsExplorer</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Efficient Visualization of Regression Coefficients for LM, GLM, and GLMNET Objects">
<meta name="description" content="The visualization tool offers a nuanced understanding of regression dynamics, going beyond traditional per-unit interpretation of continuous variables versus categorical ones. It highlights the impact of unit changes as well as larger shifts like interquartile changes, acknowledging the distribution of empirical data. Furthermore, it generates visualizations depicting alterations in Odds Ratios for predictors across minimum, first quartile, median, third quartile, and maximum values, aiding in comprehending predictor-outcome interplay within empirical data distributions, particularly in logistic regression frameworks.">
<meta property="og:description" content="The visualization tool offers a nuanced understanding of regression dynamics, going beyond traditional per-unit interpretation of continuous variables versus categorical ones. It highlights the impact of unit changes as well as larger shifts like interquartile changes, acknowledging the distribution of empirical data. Furthermore, it generates visualizations depicting alterations in Odds Ratios for predictors across minimum, first quartile, median, third quartile, and maximum values, aiding in comprehending predictor-outcome interplay within empirical data distributions, particularly in logistic regression frameworks.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">RegrCoeffsExplorer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.0000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/BetaVisualizer.html">BetaVisualizer</a></li>
    <li><a class="dropdown-item" href="articles/OddsRatioVisualizer.html">OddsRatioVisualizer</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level2">
<h2 id="regressviz">RegressViz<a class="anchor" aria-label="anchor" href="#regressviz"></a>
</h2>
<p><em>The size of the regression weight depends on the other predictor variables included in the equation and is, therefore, prone to change across situations involving different combinations of predictors</em> (Dunlap and Landis 1998).</p>
<p><em>Any interpretations of weights must be considered context-specific</em> (Thompson 1999).</p>
<p><em>Dissemination of complex information derived from sophisticated statistical models requires diligence</em> (Chen 2003).</p>
<p>The <strong>goal</strong> of <code>RegressViz</code> is to <strong>enhance the interpretation</strong> of regression results by providing <strong>visualizations</strong> that integrate empirical data distributions. This approach facilitates a more thorough understanding of the impacts of changes exceeding one unit in the independent variables on the dependent variable for models fitted within Linear Models (LM), Generalized Linear Models (GLM), and Elastic-Net Regularized Generalized Linear Models (GLMNET) frameworks.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the current version of <code>RegrCoeffsExplorer</code> from <a href="https://github.com/kaushikrohit004/RegressViz-Empirical-Coefficient-Explorer" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"kaushikrohit004/RegressViz-Empirical-Coefficient-Explorer"</span>,    </span>
<span>                         ref <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>                         dependencies <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, you can use the <code>remotes</code> library with the following command: <code>remotes::install_github()</code>.</p>
</div>
<div class="section level2">
<h2 id="a-very-brief-recap-on-logistic-regression">A Very Brief Recap on Logistic Regression<a class="anchor" aria-label="anchor" href="#a-very-brief-recap-on-logistic-regression"></a>
</h2>
<p>Logistic regression (McCullagh and Nelder 1989) is a statistical method used for binary classification. Unlike linear regression, which predicts continuous outcomes, logistic regression predicts the probability of a binary outcome (1 or 0, Yes or No, True or False). The core function in logistic regression is the logistic function, also known as the <strong>sigmoid function</strong>, which maps any input into the range (0, 1), making it interpretable as a <strong>probability</strong>. In logistic regression, we model the <strong>log odds</strong> (logarithm of Odds Ratio) of the probability as a linear function of the input features.</p>
<p>Sigmoid function is defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïƒ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>âˆ’</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\sigma(z)=\frac{1}{1+\exp(-z)}</annotation></semantics></math></p>
<p>Probability of <strong>success</strong> is calculated in the following manner:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><mi>ğ—</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Ï€</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><mi>â€¦</mi><mo>+</mo><msub><mi>Î²</mi><mi>n</mi></msub><msub><mi>X</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><mi>â€¦</mi><mo>+</mo><msub><mi>Î²</mi><mi>n</mi></msub><msub><mi>X</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>âˆ’</mo><mi>ğ—</mi><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">P(Y=1|\mathbf{X}) = \pi(\mathbf{X}) = \frac{\exp(\beta_{0}+\beta_{1}X_{1}+\ldots+\beta_{n}X_{n})}{1+\exp(\beta_{0}+\beta_{1}X_{1}+\ldots+\beta_{n}X_{n})} =\frac{\exp(\mathbf{X}\beta)}{1+\exp(\mathbf{X}\beta)} = \frac{1}{1+\exp(-\mathbf{X}\beta)}</annotation></semantics></math></p>
<p>Odds Ratio is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>R</mi><mo>=</mo><mfrac><mrow><mi>Ï€</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>âˆ’</mo><mi>Ï€</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow></mfrac><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><mi>â€¦</mi><mo>+</mo><msub><mi>Î²</mi><mi>n</mi></msub><msub><mi>X</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">OR = \frac{\pi(\mathbf{X})}{1-\pi(\mathbf{X})} =\frac{\frac{\exp(\mathbf{X}\beta)}{1+\exp(\mathbf{X}\beta)}}{1- \frac{\exp(\mathbf{X}\beta)}{1+\exp(\mathbf{X}\beta)}} =\exp(\beta_{0}+\beta_{1}X_{1}+\ldots+\beta_{n}X_{n})</annotation></semantics></math></p>
<p>Log Odds or the Logistic Transformation of the probability of success is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mi>O</mi><mi>R</mi></mrow><mo>=</mo><mo>log</mo><mfrac><mrow><mi>Ï€</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>âˆ’</mo><mi>Ï€</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><mi>â€¦</mi><mo>+</mo><msub><mi>Î²</mi><mi>n</mi></msub><msub><mi>X</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\log{OR}=\log{\frac{\pi(\mathbf{X})}{1-\pi(\mathbf{X})}} =\beta_{0}+\beta_{1}X_{1}+\ldots+\beta_{n}X_{n}</annotation></semantics></math></p>
<p>Change in log odds when one predictor variable (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_{1}</annotation></semantics></math>) increases by one unit, while <strong>all other variables remain unchanged</strong>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>ğ—</mi><mrow><msub><mi>ğ—</mi><mn>ğŸ</mn></msub><mo mathvariant="bold">=</mo><msub><mi>ğ—</mi><mn>ğŸ</mn></msub><mo mathvariant="bold">+</mo><mn>ğŸ</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mn>0</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>ğ—</mi><mrow><msub><mi>ğ—</mi><mn>ğŸ</mn></msub><mo mathvariant="bold">=</mo><msub><mi>ğ—</mi><mn>ğŸ</mn></msub><mo mathvariant="bold">+</mo><mn>ğŸ</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>âˆ’</mo><mo>log</mo><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>ğ—</mi><mrow><msub><mi>ğ—</mi><mn>ğŸ</mn></msub><mo mathvariant="bold">=</mo><msub><mi>ğ—</mi><mn>ğŸ</mn></msub></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mn>0</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>ğ—</mi><mrow><msub><mi>ğ—</mi><mn>ğŸ</mn></msub><mo mathvariant="bold">=</mo><msub><mi>ğ—</mi><mn>ğŸ</mn></msub></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mover><mo>=</mo><mn>1</mn></mover></mrow><annotation encoding="application/x-tex">\log{\frac{P(Y=1|\mathbf{X_{X_1=X_1+1}})}{P(Y=0|\mathbf{X_{X_1=X_1+1}})}} -\log{\frac{P(Y=1|\mathbf{X_{X_1=X_1}})}{P(Y=0|\mathbf{X_{X_1=X_1}})}} \overset{1}{=}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mo>=</mo><mn>1</mn></mover><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>â€¦</mi><mo>+</mo><msub><mi>Î²</mi><mi>n</mi></msub><msub><mi>X</mi><mi>n</mi></msub><mo>âˆ’</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><mi>â€¦</mi><mo>+</mo><msub><mi>Î²</mi><mi>n</mi></msub><msub><mi>X</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Î²</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\overset{1}{=} \beta_{0}+\beta_{1}(X_{1}+1)+\ldots+\beta_{n}X_{n} - (\beta_{0}+\beta_{1}X_{1}+\ldots+\beta_{n}X_{n}) =\beta_{1}</annotation></semantics></math></p>
<p>Therefore, coefficient <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î²</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\beta_{1}</annotation></semantics></math> shows expected change in the Log Odds for a one unit increase in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>. Thus, expected change in the Odds Ratio is <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\exp(\beta_{1})</annotation></semantics></math>. Finally, expected change in the Odds Ratio if <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math> changes by k units whilst all other variables remain unchanged is <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">[</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>k</mi></msup><annotation encoding="application/x-tex">[\exp(\beta_{1})]^k</annotation></semantics></math> or <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>1</mn></msub><mo>Ã—</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\exp(\beta_{1} \times k)</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="consider-implications-of-a-change-exceeding-one-unit-on-the-odds-ratio">Consider implications of a change exceeding one unit on the Odds Ratio<a class="anchor" aria-label="anchor" href="#consider-implications-of-a-change-exceeding-one-unit-on-the-odds-ratio"></a>
</h3>
<p>To generate a dataset for logistic regression analysis, we simulate four continuous predictor variables and one categorical predictor variable. The continuous predictors are sampled from a normal distribution, each with distinct means and standard deviations. The categorical predictor is generated as a dummy variable with two levels. The binary response variable is calculated by applying a logistic function to a linear combination of the predictors, thereby transforming the latent variable to a probability scale, which serves as the basis for generating binary outcomes through a binomial sampling process.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vadimtyuryaev.github.io/RegrCoeffsExplorer/">RegrCoeffsExplorer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1945</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set the number of observations</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># Random means and SDs</span></span>
<span><span class="va">r_means</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">4</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">r_sd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">4</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate predictor variables</span></span>
<span><span class="va">X1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">r_means</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, sd <span class="op">=</span> <span class="va">r_sd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">X2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">r_means</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, sd <span class="op">=</span> <span class="va">r_sd</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">X3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">r_means</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, sd <span class="op">=</span> <span class="va">r_sd</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">X4</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">r_means</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, sd <span class="op">=</span> <span class="va">r_sd</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a dummy variable</span></span>
<span><span class="va">F_dummy</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Convert to factor</span></span>
<span><span class="va">Factor_var</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">F_dummy</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define coefficients for each predictor</span></span>
<span><span class="va">beta_0</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.45</span></span>
<span><span class="va">beta_1</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.35</span></span>
<span><span class="va">beta_2</span> <span class="op">=</span> <span class="fl">1.05</span></span>
<span><span class="va">beta_3</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.7</span></span>
<span><span class="va">beta_4</span> <span class="op">=</span> <span class="fl">0.55</span>  </span>
<span><span class="va">beta_5</span> <span class="op">=</span> <span class="fl">1.25</span></span>
<span></span>
<span><span class="co"># Generate the latent variable</span></span>
<span><span class="va">latent_variable</span> <span class="op">=</span> <span class="va">beta_0</span> <span class="op">+</span> <span class="va">beta_1</span><span class="op">*</span><span class="va">X1</span> <span class="op">+</span> <span class="va">beta_2</span><span class="op">*</span><span class="va">X2</span> <span class="op">+</span> <span class="va">beta_3</span><span class="op">*</span><span class="va">X3</span> <span class="op">+</span> <span class="va">beta_4</span><span class="op">*</span><span class="va">X4</span> <span class="op">+</span><span class="va">beta_5</span><span class="op">*</span><span class="va">F_dummy</span></span>
<span></span>
<span><span class="co"># Convert the latent variable to probabilities using the logistic function</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">latent_variable</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">latent_variable</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate binomial outcomes based on these probabilities</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a GLM with a logistic link, including the factor variable</span></span>
<span><span class="va">glm_model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span> <span class="op">+</span> <span class="va">Factor_var</span>, </span>
<span>                family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">X1</span>, <span class="va">X2</span>, <span class="va">X3</span>, <span class="va">X4</span>, <span class="va">Factor_var</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="fu"><a href="reference/vis_reg.html">vis_reg</a></span><span class="op">(</span><span class="va">glm_model</span>, CI <span class="op">=</span> <span class="cn">TRUE</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dodgerblue"</span>, <span class="st">"gold"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="st">"SidebySide"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example-1.png" width="100%"></p>
<p>Note that upon consideration of the empirical distribution of data, particularly concerning the influence on the response variable, <code>y</code>, attributable to the interquartile change (Q3-Q1) in the dependent variables, there is a discernible enlargement in the magnitudes of coefficients <code>X2</code> and <code>X4</code>.</p>
<p>Let us delve further into the underlying reasons for this phenomenon.</p>
</div>
<div class="section level3">
<h3 id="check-estimated-coefficients">Check estimated coefficients<a class="anchor" aria-label="anchor" href="#check-estimated-coefficients"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glm_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = y ~ X1 + X2 + X3 + X4 + Factor_var, family = binomial(link = "logit"), </span></span>
<span><span class="co">#&gt;     data = data.frame(y, X1, X2, X3, X4, Factor_var))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept) -1.12972    0.54095  -2.088   0.0368 *  </span></span>
<span><span class="co">#&gt; X1          -0.30907    0.04524  -6.831 8.42e-12 ***</span></span>
<span><span class="co">#&gt; X2           1.13339    0.09617  11.785  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; X3          -0.65286    0.08637  -7.559 4.06e-14 ***</span></span>
<span><span class="co">#&gt; X4           0.53535    0.04935  10.848  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; Factor_var1  1.21505    0.16635   7.304 2.79e-13 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 1371.37  on 999  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance:  930.71  on 994  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 942.71</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="obtain-odds-ratio-or">Obtain Odds Ratio (OR)<a class="anchor" aria-label="anchor" href="#obtain-odds-ratio-or"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glm_model</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Intercept)          X1          X2          X3          X4 Factor_var1 </span></span>
<span><span class="co">#&gt;   0.3231247   0.7341269   3.1061734   0.5205559   1.7080454   3.3704659</span></span></code></pre></div>
<p>The coefficients for <code>X1</code> through <code>X4</code> represent the change in the OR for a <strong>one-unit shift</strong> in each respective coefficient, while the coefficient for <code>Factor_var1</code> signifies the variation in OR resulting from a transition from the reference level of 0 to a level 1 in the factor variable. At first glance, it may seem that the factor variable exerts the most significant impact on the odds ratio.Yet, this interpretation can often be deceptive, as it fails to take into account the distribution of empirical data.</p>
</div>
<div class="section level3">
<h3 id="real-data-differences">Real data differences<a class="anchor" aria-label="anchor" href="#real-data-differences"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Calculate all possible differences (1000 choose 2)</span></span>
<span><span class="va">all_diffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="va">X2</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Count differences that are exactly 1 units</span></span>
<span><span class="va">num_diffs_exactly_one</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">all_diffs</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Count the proportion of differences that more or equal to 2 units</span></span>
<span><span class="va">num_diffs_2_or_more</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">all_diffs</span><span class="op">)</span><span class="op">&gt;=</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">all_diffs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Number of differences of exactly 1 unit:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Number of differences of exactly 1 unit:"</span></span>
<span><span class="va">num_diffs_exactly_one</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Proportion of differences of two or more units:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Proportion of differences of two or more units:"</span></span>
<span><span class="va">num_diffs_2_or_more</span></span>
<span><span class="co">#&gt; [1] 0.1500364</span></span></code></pre></div>
<p><strong>None</strong> of the differences observed within the values of the variable <code>X2</code> equate to a single unit. Furthermore, <strong>in excess of 15 percent</strong> of these differences are equal or surpass a magnitude of two units.Therefore, when analyzing standard regression output displaying per-unit interpretations, we, in a sense, comment on difference that might not exist in the real data.Consequently, when engaging in the analysis of standard regression outputs that provide interpretations on a per-unit basis, there is an implicit commentary on disparities that may not be present within the actual data. A more realistic approach is to utilize an actual observable difference, for example <code>Q3</code>-<code>Q1</code>, to calculate the OR.</p>
</div>
<div class="section level3">
<h3 id="plot-changes-in-or-and-empirical-data-distribution-for-the-x2-variable">Plot changes in OR and empirical data distribution for the <code>X2</code> variable<a class="anchor" aria-label="anchor" href="#plot-changes-in-or-and-empirical-data-distribution-for-the-x2-variable"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_OR.html">plot_OR</a></span><span class="op">(</span><span class="va">glm_model</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">X1</span>, <span class="va">X2</span>, <span class="va">X3</span>, <span class="va">X4</span>, <span class="va">Factor_var</span><span class="op">)</span>, </span>
<span>        var_name<span class="op">=</span><span class="st">"X2"</span>,</span>
<span>        color_filling<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#008000"</span>, <span class="st">"#FFFF00"</span>,<span class="st">"#FFA500"</span>,<span class="st">"#FF0000"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="st">"SidebySide"</span></span></code></pre></div>
<p><img src="reference/figures/README-plot-Odds-Ratio-1.png" width="100%"></p>
<p>The top plot delineates the variations in the OR corresponding to data differentials spanning from the minimum to the first quartile (Q1), the median (Q2), the third quartile (Q3), and the maximum.The bottom plot depicts a boxplot with a notch to display a confidence interval around the median and jitters to add random noise to data points preventing overlap and revealing the underlying data distribution more clearly. Substantial changes in the OR progressing alone the empirical data are clearly observed.</p>
</div>
<div class="section level3">
<h3 id="customize-plots---12">Customize plots - 1/2<a class="anchor" aria-label="anchor" href="#customize-plots---12"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/vis_reg.html">vis_reg</a></span><span class="op">(</span><span class="va">glm_model</span>, CI <span class="op">=</span> <span class="cn">TRUE</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dodgerblue"</span>, <span class="st">"gold"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">PerUnitVis</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Visualization of Log Odds Model Results (per unit change)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Predictors"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Estimated OR"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"whitesmoke"</span> <span class="op">)</span><span class="op">)</span><span class="op">+</span>                            </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>   </span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"> As observed, when returning individual plots, the resulting entities are <code>ggplot</code> objects. Consequently, any operation that is compatible with ggplot can be applied to these plots using the <code>+</code> operator.</p>
</div>
<div class="section level3">
<h3 id="customize-plots---22">Customize plots - 2/2<a class="anchor" aria-label="anchor" href="#customize-plots---22"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/vis_reg.html">vis_reg</a></span><span class="op">(</span><span class="va">glm_model</span>, CI <span class="op">=</span> <span class="cn">TRUE</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dodgerblue"</span>, <span class="st">"gold"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">RealizedEffectVis</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#DC143C"</span>,<span class="st">"#DCDCDC"</span> <span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glm_model</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/IQR.html" class="external-link">IQR</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span><span class="op">)</span>, <span class="co"># note the calculation</span></span>
<span>             linetype<span class="op">=</span><span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"orange"</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="vignettes">Vignettes<a class="anchor" aria-label="anchor" href="#vignettes"></a>
</h2>
<p>Would you like to know more? Please, check out the in-depth vignettes below.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"BetaVisualizer"</span>, </span>
<span>         package <span class="op">=</span> <span class="st">"RegrCoeffsExplorer"</span><span class="op">)</span>  <span class="co"># To visualize realized effect sizes </span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"OddsRatioVisualizer"</span>,           <span class="co"># To visualize Odds Ratios</span></span>
<span>         package <span class="op">=</span> <span class="st">"RegrCoeffsExplorer"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-note-on-estimation-of-confidence-intervals-for-objects-fitted-using-regularized-regression">A note on estimation of Confidence Intervals for objects fitted using regularized regression<a class="anchor" aria-label="anchor" href="#a-note-on-estimation-of-confidence-intervals-for-objects-fitted-using-regularized-regression"></a>
</h2>
<p>It is imperative to to gain a comprehensive understanding of the post-selection inference (Hastie, Tibshirani, and Wainwright 2015) rationale and methodologies prior to the generation and graphical representation of confidence intervals for objects fitted via the Elastic-Net Regularized Generalized Linear Models. Please, kindly consult the hyperlinks below containing the designated literature and the <code>BetaVisualizer</code> vignette.</p>
<ol style="list-style-type: decimal">
<li><a href="https://www.ime.unicamp.br/~dias/SLS.pdf" class="external-link">Statistical Learning with Sparsity</a></li>
<li><a href="https://www.math.wustl.edu/~kuffner/TibshiraniSlides.pdf" class="external-link">Recent Advances in Post-Selection Statistical Inference</a></li>
<li><a href="https://cran.r-project.org/web/packages/selectiveInference/selectiveInference.pdf" class="external-link">Tools for Post-Selection Inference</a></li>
</ol>
</div>
<div class="section level2">
<h2 id="a-cautionary-note-on-intepretation-of-interaction-effects-in-generalized-linear-models-glm">A cautionary note on intepretation of interaction effects in Generalized Linear Models (GLM)<a class="anchor" aria-label="anchor" href="#a-cautionary-note-on-intepretation-of-interaction-effects-in-generalized-linear-models-glm"></a>
</h2>
<p>A frequently misrepresented and misunderstood concept is that coefficients for interaction terms in GLMs <strong>do not</strong> have straightforward slope interpretations. This implies, among other considerations, that in models including interaction terms, the ORs derived from coefficients might not be meaningful (Chen 2003). Many situations demand recalculation of correct ORs, and the interpretation of interaction terms depends on other predictors in the model due to inherent non-linearity. Consequently, researchers should exercise caution when including and interpreting interaction terms in GLM models.</p>
<p>In the following, we adopt the approach by McCabe et al.Â (2021) to demonstrate computationally how interactions may depend on all predictors in the model and how these interactions can be estimated and interpreted on the probability scale.</p>
<div class="section level3">
<h3 id="theoretical-considerations-regarding-the-interpretation-of-interaction-terms">Theoretical considerations regarding the interpretation of interaction terms<a class="anchor" aria-label="anchor" href="#theoretical-considerations-regarding-the-interpretation-of-interaction-terms"></a>
</h3>
<p>Consider a Linear Model with two continuous predictors and an interaction term:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ—</mtext><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>12</mn></msub><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">E[Y|\textbf{X}] = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_{12} x_1 x_2</annotation></semantics></math></p>
<p>Define the <strong>marginal effect</strong> by taking the partial derivative with respect to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>2</mn></msub><annotation encoding="application/x-tex">x_2</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î³</mi><mn>2</mn></msub><mo>=</mo><mfrac><mrow><mi>âˆ‚</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ—</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mi>âˆ‚</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac><mo>=</mo><msub><mi>Î²</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\gamma_2 = \frac{\partial E[Y|\textbf{X}]}{\partial x_2} = \beta_2</annotation></semantics></math></p>
<p>Therefore, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î²</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\beta_2</annotation></semantics></math> is sufficient to quantify how much <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ—</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y|\textbf{X}]</annotation></semantics></math> changes with respect to every one unit increase in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î²</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\beta_2</annotation></semantics></math>, holding all other variables constant.</p>
<p>Now, take the second order cross-partial derivative of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ—</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y|\textbf{X}]</annotation></semantics></math> with respect to both <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>2</mn></msub><annotation encoding="application/x-tex">x_2</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î³</mi><mn>12</mn><mn>2</mn></msubsup><mo>=</mo><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ—</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mi>âˆ‚</mi><msub><mi>x</mi><mn>1</mn></msub><mi>âˆ‚</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac><mo>=</mo><msub><mi>Î²</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">\gamma_{12}^2 = \frac{\partial^2 E[Y| \textbf{X}]}{\partial x_1 \partial x_2} = \beta_{12}</annotation></semantics></math></p>
<p>Similar intuition as above holds. The interaction term <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î²</mi><mn>12</mn></msub><annotation encoding="application/x-tex">\beta_{12}</annotation></semantics></math> shows how effect of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math> on <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ—</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y|\textbf{X}]</annotation></semantics></math> changes for every one unit increase in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>2</mn></msub><annotation encoding="application/x-tex">x_2</annotation></semantics></math> and vice versa.</p>
<p>Now consider a logistic regression model with a non-linear link function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>â‹…</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(\cdot)</annotation></semantics></math>, two continuous predictors and an interaction term:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ—</mtext><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>12</mn></msub><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">g(E[Y|\textbf{X}])=\beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_{12} x_1 x_2</annotation></semantics></math></p>
<p>Converting GLM to a natural scale using the inverse link function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ—</mtext><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msup><mi>g</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>12</mn></msub><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y|\textbf{X}]=g^{-1}(\beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_{12} x_1 x_2)</annotation></semantics></math></p>
<p>Note that the relationship is <strong>no longer linear</strong>.</p>
<p>As an example, consider logistic regression:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ—</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mn>1</mn><mo>âˆ’</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ—</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>12</mn></msub><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mi>Î·</mi></mrow><annotation encoding="application/x-tex">\log(\frac{E[Y|\textbf{X}]}{1-E[Y|\textbf{X}]})=\beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_{12} x_1 x_2=\eta</annotation></semantics></math></p>
<p>Transformation leads to:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ—</mtext><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>âˆ’</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>12</mn></msub><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">}</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>âˆ’</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">E[Y|\textbf{X}]=\frac{1}{1+exp(-\{\beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_{12} x_1 x_2\})}=\frac{1}{1+exp(-\eta)}=\frac{exp(\eta)}{1+exp(\eta)}</annotation></semantics></math></p>
<p>Letâ€™s take the second order cross-partial derivative.</p>
<p>Using the chain rule:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î³</mi><mn>12</mn><mn>2</mn></msubsup><mo>=</mo><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ—</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mrow><mi>âˆ‚</mi><msub><mi>x</mi><mn>1</mn></msub><mi>âˆ‚</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><msup><mi>g</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>âˆ‚</mi><msub><mi>x</mi><mn>1</mn></msub><mi>âˆ‚</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mi>âˆ‚</mi><mrow><mi>âˆ‚</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><mi>âˆ‚</mi><msup><mi>g</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>âˆ‚</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mover><mo>=</mo><mn>2</mn></mover></mrow><annotation encoding="application/x-tex">\gamma_{12}^2 = \frac{\partial^2 E[Y|\textbf{X}]}{\partial x_1 \partial x_2} = \frac{\partial^2 g^{-1}(\eta)}{\partial x_1 \partial x_2} = \frac{\partial }{\partial x_1} \left[ \frac{\partial g^{-1}(\eta)}{\partial x_2} \right] \overset{2}{=}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mo>=</mo><mn>2</mn></mover><mfrac><mi>âˆ‚</mi><mrow><mi>âˆ‚</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><mi>âˆ‚</mi><msup><mi>g</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>âˆ‚</mi><mi>Î·</mi></mrow></mfrac><mfrac><mrow><mi>âˆ‚</mi><mi>Î·</mi></mrow><mrow><mi>âˆ‚</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><mi>âˆ‚</mi><mrow><mi>âˆ‚</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>2</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>12</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mover><mi>g</mi><mo accent="true">Ì‡</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\overset{2}{=} \frac{\partial}{\partial x_1} \left[ \frac{\partial g^{-1}(\eta)}{\partial \eta} \frac{\partial \eta}{ \partial x_2} \right] = \frac{\partial}{\partial x_1} [(\beta_2+\beta_{12} x_1)\dot{g}^{-1}(\eta)]</annotation></semantics></math></p>
<p>Utilizing the product rule followed by the chain rule:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>âˆ‚</mi><mrow><mi>âˆ‚</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>2</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>12</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mover><mi>g</mi><mo accent="true">Ì‡</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><mi>âˆ‚</mi><mrow><mi>âˆ‚</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>2</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>12</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><msup><mover><mi>g</mi><mo accent="true">Ì‡</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>2</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>12</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mfrac><mi>âˆ‚</mi><mrow><mi>âˆ‚</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><msup><mover><mi>g</mi><mo accent="true">Ì‡</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mover><mo>=</mo><mn>3</mn></mover></mrow><annotation encoding="application/x-tex">\frac{\partial}{\partial x_1} \left[(\beta_2+\beta_{12} x_1)\dot{g}^{-1}(\eta) \right] =\frac{\partial}{\partial x_1} [(\beta_2+\beta_{12} x_1)]\dot{g}^{-1}(\eta) +  [(\beta_2+\beta_{12} x_1)]\frac{\partial}{\partial x_1}[\dot{g}^{-1}(\eta)] \overset{3}{=}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mo>=</mo><mn>3</mn></mover><msub><mi>Î²</mi><mn>12</mn></msub><msup><mover><mi>g</mi><mo accent="true">Ì‡</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>2</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>12</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>1</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>12</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mover><mi>g</mi><mo accent="true">Ìˆ</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\overset{3}{=} \beta_{12} \dot{g}^{-1}(\eta)+(\beta_2+\beta_{12}x_1)(\beta_1+\beta_{12}x_2)\ddot{g}^{-1}(\eta)</annotation></semantics></math></p>
<p>First and second derivative of the inverse link function are:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover><mi>g</mi><mo accent="true">Ì‡</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">\dot{g}^{-1}(\eta)=\frac{exp(\eta)}{(1+exp(\eta))^2}</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover><mi>g</mi><mo accent="true">Ìˆ</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>3</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">\ddot{g}^{-1}(\eta)=\frac{exp(\eta)(1-exp(\eta))}{(1+exp(\eta))^3}</annotation></semantics></math></p>
<p>Therefore:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î³</mi><mn>12</mn><mn>2</mn></msubsup><mo>=</mo><msub><mi>Î²</mi><mn>12</mn></msub><mfrac><msup><mi>e</mi><mi>Î·</mi></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mi>Î·</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>1</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>12</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>2</mn></msub><mo>+</mo><msub><mi>Î²</mi><mn>12</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mrow><msup><mi>e</mi><mi>Î·</mi></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><msup><mi>e</mi><mi>Î·</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mi>Î·</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>3</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">\gamma_{12}^2=\beta_{12} \frac{e^{\eta}}{(1+e^{\eta})^2}+(\beta_1+\beta_{12}x_2)(\beta_2+\beta_{12}x_1)\frac{e^{\eta}(1-e^{\eta})}{(1+e^{\eta})^3}</annotation></semantics></math></p>
<p>Calculation above show that an interaction term in GLMs depends on all predictors within the model.This implies that the coefficient <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î²</mi><mn>12</mn></msub><annotation encoding="application/x-tex">\beta_{12}</annotation></semantics></math> alone does not adequately describe how the effect of variable <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math> on <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ—</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y|\textbf{X}]</annotation></semantics></math> changes for each one-unit increase in the variable <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>2</mn></msub><annotation encoding="application/x-tex">x_2</annotation></semantics></math>, and vice versa.</p>
</div>
<div class="section level3">
<h3 id="computational-perspectives-on-interaction-terms-in-generalized-linear-models">Computational perspectives on interaction terms in Generalized Linear Models<a class="anchor" aria-label="anchor" href="#computational-perspectives-on-interaction-terms-in-generalized-linear-models"></a>
</h3>
<p>We sample two moderately correlated predictors <code>X1b</code> and <code>X2b</code> from a standard bivariate normal distribution and use them to simulate a logistic regression model. By fitting the model, we obtain the estimated coefficients and calculate the values of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mover><mi>Î³</mi><mo accent="true">Ì‚</mo></mover><mn>12</mn><mn>2</mn></msubsup><annotation encoding="application/x-tex">\hat{\gamma}^2_{12}</annotation></semantics></math>. Subsequently, we visualize the slopes of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>E</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mi>ğ—</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{E}[Y|\mathbf{X}]</annotation></semantics></math> calculated for several combinations of <code>X1b</code> and <code>X2b</code>.</p>
<div class="section level4">
<h4 id="sample-two-predictors-x1b-and-x2b-from-a-standard-bivariate-normal-distribution">Sample two predictors <code>X1b</code> and <code>X2b</code> from a standard bivariate normal distribution:<a class="anchor" aria-label="anchor" href="#sample-two-predictors-x1b-and-x2b-from-a-standard-bivariate-normal-distribution"></a>
</h4>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>X</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>X</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ¼</mo><mi>ğ’©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Î¼</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Î¼</mi><mn>2</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>Ïƒ</mi><mn>1</mn><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mi>Ï</mi><msub><mi>Ïƒ</mi><mn>1</mn></msub><msub><mi>Ïƒ</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>Ï</mi><msub><mi>Ïƒ</mi><mn>1</mn></msub><msub><mi>Ïƒ</mi><mn>2</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>Ïƒ</mi><mn>2</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left( \begin{array}{c}
X_1 \\
X_2
\end{array} \right)
\sim \mathcal{N}\left(
\begin{array}{c}
\begin{pmatrix}
\mu_1 \\
\mu_2
\end{pmatrix}
\end{array},
\begin{pmatrix}
\sigma_1^2 &amp; \rho \sigma_1 \sigma_2 \\
\rho \sigma_1 \sigma_2 &amp; \sigma_2^2
\end{pmatrix}
\right)</annotation></semantics></math></p>
<p>Recall that the the pdf of the bivariate normal distribution has the following form (Pennsylvania State University 2024):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>Ï€</mi><msub><mi>Ïƒ</mi><mn>1</mn></msub><msub><mi>Ïƒ</mi><mn>2</mn></msub><msqrt><mrow><mn>1</mn><mo>âˆ’</mo><msup><mi>Ï</mi><mn>2</mn></msup></mrow></msqrt></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>âˆ’</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><msup><mi>Ï</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>Î¼</mi><mn>1</mn></msub></mrow><msub><mi>Ïƒ</mi><mn>1</mn></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>âˆ’</mo><mn>2</mn><mi>Ï</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>Î¼</mi><mn>1</mn></msub></mrow><msub><mi>Ïƒ</mi><mn>1</mn></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>Î¼</mi><mn>2</mn></msub></mrow><msub><mi>Ïƒ</mi><mn>2</mn></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>Î¼</mi><mn>2</mn></msub></mrow><msub><mi>Ïƒ</mi><mn>2</mn></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\phi(x_1, x_2) = \frac{1}{2\pi \sigma_1 \sigma_2 \sqrt{1 - \rho^2}} \exp\left(-\frac{1}{2(1 - \rho^2)} \left[ \left(\frac{x_1 - \mu_1}{\sigma_1}\right)^2 - 2\rho \left(\frac{x_1 - \mu_1}{\sigma_1}\right) \left(\frac{x_2 - \mu_2}{\sigma_2}\right) + \left(\frac{x_2 - \mu_2}{\sigma_2}\right)^2 \right] \right)</annotation></semantics></math></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load necessary library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span>          <span class="co"># for sampling from a multivariate normal distribution</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span>      <span class="co"># for melting data frames</span></span>
<span></span>
<span><span class="co"># Set parameters</span></span>
<span><span class="va">n_samples</span>   <span class="op">=</span> <span class="fl">1000</span>     <span class="co"># Number of samples</span></span>
<span><span class="va">mean_vector</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>  <span class="co"># Mean vector for X1 and X2</span></span>
<span><span class="va">std_devs</span>    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># Standard deviations for X1 and X2</span></span>
<span><span class="va">correlation</span> <span class="op">=</span> <span class="fl">0.6</span>      <span class="co"># Correlation between X1 and X2</span></span>
<span></span>
<span><span class="co"># Generate the covariance matrix</span></span>
<span><span class="va">cov_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">std_devs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span>, </span>
<span>                       <span class="va">std_devs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">std_devs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">correlation</span>, </span>
<span>                       <span class="va">std_devs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">std_devs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">correlation</span>, </span>
<span>                       <span class="va">std_devs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                    nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate samples from the bivariate normal distribution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span>  </span>
<span><span class="va">samples</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_samples</span>, mu <span class="op">=</span> <span class="va">mean_vector</span>, Sigma <span class="op">=</span> <span class="va">cov_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert samples to a data frame</span></span>
<span><span class="va">bivariate_sample_df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X1 <span class="op">=</span> <span class="va">samples</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, X2 <span class="op">=</span> <span class="va">samples</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">X1b</span> <span class="op">=</span> <span class="va">bivariate_sample_df</span><span class="op">$</span><span class="va">X1</span></span>
<span><span class="va">X2b</span> <span class="op">=</span> <span class="va">bivariate_sample_df</span><span class="op">$</span><span class="va">X2</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="fit-logistic-model-with-an-interaction-term">Fit logistic model with an interaction term:<a class="anchor" aria-label="anchor" href="#fit-logistic-model-with-an-interaction-term"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set parameters</span></span>
<span><span class="va">n_samples</span> <span class="op">=</span>  <span class="fl">1000</span></span>
<span><span class="va">beta_0</span>    <span class="op">=</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">beta_1</span>    <span class="op">=</span>  <span class="fl">2</span></span>
<span><span class="va">beta_2</span>    <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span></span>
<span><span class="va">beta_3</span>    <span class="op">=</span>  <span class="fl">0.5</span>   <span class="co"># Coefficient for the interaction term</span></span>
<span></span>
<span><span class="co"># Calculate probabilities including interaction term</span></span>
<span><span class="va">log_odds</span> <span class="op">=</span> <span class="va">beta_0</span> <span class="op">+</span> <span class="va">beta_1</span> <span class="op">*</span> <span class="va">X1b</span> <span class="op">+</span> <span class="va">beta_2</span> <span class="op">*</span> <span class="va">X2b</span> <span class="op">+</span> <span class="va">beta_3</span> <span class="op">*</span> <span class="va">X1b</span> <span class="op">*</span> <span class="va">X2b</span></span>
<span><span class="va">prob</span>     <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">log_odds</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate response variable</span></span>
<span><span class="va">Y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_samples</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">prob</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit logistic regression</span></span>
<span><span class="va">data</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y</span>, X1 <span class="op">=</span> <span class="va">X1b</span>, X2 <span class="op">=</span> <span class="va">X2b</span>, X1X2 <span class="op">=</span> <span class="va">X1b</span> <span class="op">*</span> <span class="va">X2b</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X1X2</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print estimated coefficients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = Y ~ X1 + X2 + X1X2, family = binomial(link = "logit"), </span></span>
<span><span class="co">#&gt;     data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept) -1.23161    0.10766  -11.44  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; X1           2.17753    0.15377   14.16  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; X2          -1.51229    0.12617  -11.99  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; X1X2         0.68345    0.08438    8.10 5.51e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 1321.07  on 999  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance:  919.38  on 996  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 927.38</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="check-distribution-of-interaction-term-values-at-different-values-of-x1b-andx2b">Check distribution of interaction term values at different values of <code>X1b</code> and<code>X2b</code>
<a class="anchor" aria-label="anchor" href="#check-distribution-of-interaction-term-values-at-different-values-of-x1b-andx2b"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Define x1 and x2 ranges</span></span>
<span><span class="va">x1_range</span>     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">x2_quantiles</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">X2b</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the function to calculate gamma squared d[E[Y|X]]/dx1dx2</span></span>
<span><span class="va">second_derivative</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">beta</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">z</span> <span class="op">=</span> <span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">x1</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">x2</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">*</span><span class="va">x1</span><span class="op">*</span><span class="va">x2</span></span>
<span>  <span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">term1</span> <span class="op">=</span> <span class="va">beta</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>  <span class="va">term2</span> <span class="op">=</span> <span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">*</span><span class="va">x1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span></span>
<span>  <span class="va">gamma_squared</span> <span class="op">=</span> <span class="va">term1</span> <span class="op">+</span> <span class="va">term2</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">gamma_squared</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Calculate gamma squared for each combination</span></span>
<span><span class="va">gamma_squared_values</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">x1_range</span>, <span class="va">x2_quantiles</span>, <span class="fu"><a href="https://rdrr.io/r/base/Vectorize.html" class="external-link">Vectorize</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">second_derivative</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a data frame from the matrix</span></span>
<span><span class="va">gamma_df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">gamma_squared_values</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add X1 values as a column for identification</span></span>
<span><span class="va">gamma_df</span><span class="op">$</span><span class="va">X1</span> <span class="op">=</span> <span class="va">x1_range</span></span>
<span></span>
<span><span class="co"># Melt the data frame for use with ggplot</span></span>
<span><span class="va">long_gamma_df</span> <span class="op">=</span> <span class="fu">melt</span><span class="op">(</span><span class="va">gamma_df</span>, id.vars <span class="op">=</span> <span class="st">"X1"</span>, </span>
<span>                     variable.name <span class="op">=</span> <span class="st">"X2_Quantile"</span>,</span>
<span>                     value.name <span class="op">=</span> <span class="st">"GammaSquared"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert X2_Quantile to a factor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">long_gamma_df</span><span class="op">$</span><span class="va">X2_Quantile</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"25%"</span>, <span class="st">"50%"</span>, <span class="st">"75%"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the boxplot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">long_gamma_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X2_Quantile</span>, y <span class="op">=</span> <span class="va">GammaSquared</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Boxplot of Gamma Squared Values"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"X2b Percentile"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Gamma Squared"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"></p>
<p>Note that the estimate of the interaction term is positive (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.68345</mn><annotation encoding="application/x-tex">0.68345</annotation></semantics></math>). Yet, significant number of the gamma squared values are negative. Moreover, the magnitude and sign of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mover><mi>Î³</mi><mo accent="true">Ì‚</mo></mover><mn>12</mn><mn>2</mn></msubsup><annotation encoding="application/x-tex">\hat{\gamma}_{12}^2</annotation></semantics></math> are contingent upon the specific combination of <code>X1b</code> and <code>X2b</code> variables utilized in the analysis.</p>
</div>
<div class="section level4">
<h4 id="visualize-changes-in-hateytextbfx-associated-with-one-unit-increase-in-x1b-at-different-quantiles-of-x2b">Visualize changes in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>E</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ±</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{E}[Y|\textbf{x}]</annotation></semantics></math> associated with one unit increase in <code>X1b</code> at different quantiles of <code>X2b</code>.<a class="anchor" aria-label="anchor" href="#visualize-changes-in-hateytextbfx-associated-with-one-unit-increase-in-x1b-at-different-quantiles-of-x2b"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Generate a sequence of x1 values for plotting</span></span>
<span><span class="va">x1_values</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate predicted probabilities for each combination of x1 and quantile x2</span></span>
<span><span class="va">predictions</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x2_quantiles</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">predicted_probs</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">x1_values</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">x2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">*</span> <span class="va">x1_values</span> <span class="op">*</span> <span class="va">x2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">predicted_probs</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate values for plotting slopes</span></span>
<span><span class="va">x1_values_lines_1</span>    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">x1_values_lines_2</span>    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">x2_quantiles_lines</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">X2b</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">predictions_lines_1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x2_quantiles_lines</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">predicted_probs</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">x1_values_lines_1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">x2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">*</span> <span class="va">x1_values_lines_1</span> <span class="op">*</span> <span class="va">x2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">predicted_probs</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predictions_lines_2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x2_quantiles_lines</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">predicted_probs</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">x1_values_lines_2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">x2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">*</span> <span class="va">x1_values_lines_2</span> <span class="op">*</span> <span class="va">x2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">predicted_probs</span><span class="op">)</span> </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x1_values</span>, <span class="va">predictions</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">'l'</span>, lwd <span class="op">=</span> <span class="fl">2</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"Estimated Probability"</span>, xlab <span class="op">=</span> <span class="st">"X1b"</span>, main <span class="op">=</span> <span class="st">"Interaction Effects"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="va">predictions_lines_1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">0</span>, <span class="va">predictions_lines_1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>         col<span class="op">=</span><span class="st">"red4"</span>, lwd<span class="op">=</span><span class="fl">2.5</span>,lty<span class="op">=</span><span class="st">"dotdash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="va">predictions_lines_1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">0</span>, <span class="va">predictions_lines_1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>         col<span class="op">=</span><span class="st">"red4"</span>, lwd<span class="op">=</span><span class="fl">2.5</span>,lty<span class="op">=</span><span class="st">"dotdash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="va">predictions_lines_1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">0</span>, <span class="va">predictions_lines_1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>          col<span class="op">=</span><span class="st">"red4"</span>, lwd<span class="op">=</span><span class="fl">2.5</span>,lty<span class="op">=</span><span class="st">"dotdash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="va">predictions_lines_1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">0</span>, <span class="va">predictions_lines_1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>         col<span class="op">=</span><span class="st">"red4"</span>, lwd<span class="op">=</span><span class="fl">2.5</span>,lty<span class="op">=</span><span class="st">"dotdash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="va">predictions_lines_1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">0</span>, <span class="va">predictions_lines_1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>         col<span class="op">=</span><span class="st">"red4"</span>, lwd<span class="op">=</span><span class="fl">2.5</span>,lty<span class="op">=</span><span class="st">"dotdash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="va">predictions_lines_1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">0</span>, <span class="va">predictions_lines_1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>          col<span class="op">=</span><span class="st">"red4"</span>, lwd<span class="op">=</span><span class="fl">2.5</span>,lty<span class="op">=</span><span class="st">"dotdash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">predictions_lines_2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">1.5</span>, <span class="va">predictions_lines_2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,     </span>
<span>         col<span class="op">=</span><span class="st">"springgreen4"</span>, lwd<span class="op">=</span><span class="fl">3</span>,lty<span class="op">=</span><span class="st">"twodash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">predictions_lines_2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">1.5</span>, <span class="va">predictions_lines_2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>         col<span class="op">=</span><span class="st">"springgreen4"</span>, lwd<span class="op">=</span><span class="fl">3</span>,lty<span class="op">=</span><span class="st">"twodash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="va">predictions_lines_2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">1.5</span>, <span class="va">predictions_lines_2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>         col<span class="op">=</span><span class="st">"springgreen4"</span>, lwd<span class="op">=</span><span class="fl">3</span>,lty<span class="op">=</span><span class="st">"twodash"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">predictions_lines_2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">1.5</span>, <span class="va">predictions_lines_2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>         col<span class="op">=</span><span class="st">"springgreen4"</span>, lwd<span class="op">=</span><span class="fl">3</span>,lty<span class="op">=</span><span class="st">"solid"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">predictions_lines_2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">1.5</span>, <span class="va">predictions_lines_2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>         col<span class="op">=</span><span class="st">"springgreen4"</span>, lwd<span class="op">=</span><span class="fl">3</span>,lty<span class="op">=</span><span class="st">"solid"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="va">predictions_lines_2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">1.5</span>, <span class="va">predictions_lines_2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>         col<span class="op">=</span><span class="st">"springgreen4"</span>, lwd<span class="op">=</span><span class="fl">3</span>,lty<span class="op">=</span><span class="st">"solid"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x1_values</span>, <span class="va">predictions</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x1_values</span>, <span class="va">predictions</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, lty <span class="op">=</span> <span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"25% X2b"</span>, <span class="st">"50% X2b"</span>, <span class="st">"75% X2b"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"></p>
<p>The alterations in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>E</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ±</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{E}[Y|\textbf{x}]</annotation></semantics></math> associated with one-unit increments in <code>X1b</code> at the first and third quartiles of <code>X2b</code> demonstrate significant disparities. Observe the variations in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>E</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ±</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{E}[Y|\textbf{x}]</annotation></semantics></math> for a unit change in <code>X1b</code> from <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math> to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math> (red) compared to the changes in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>E</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="bold">ğ±</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{E}[Y|\textbf{x}]</annotation></semantics></math> for a unit change in X1b from <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.5</mn><annotation encoding="application/x-tex">0.5</annotation></semantics></math> to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1.5</mn><annotation encoding="application/x-tex">1.5</annotation></semantics></math> (green). Observe how the magnitudes of changes in the estimated probability associated with a unit increment in <code>X1b</code> vary depending on the position along the number line where the increment occurs. This observation substantiates the preliminary assertion regarding the inadequacy of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mn>12</mn></msub><annotation encoding="application/x-tex">\hat{\beta}_{12}</annotation></semantics></math> in capturing the interaction effects on the probability scale within the GLM framework, which incorporates two continuous predictors and an interaction term. Consequently, meticulous attention is required when incorporating interaction terms and interpreting the outcomes of models that include such terms.</p>
</div>
</div>
</div>
<div class="section level1">
<div class="page-header"><h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1></div>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Chen2003" class="csl-entry">
Chen, J. J. 2003. â€œCommunicating Complex Information: The Interpretation of Statistical Interaction in Multiple Logistic Regression Analysis.â€ <em>American Journal of Public Health</em> 93 (9): 1376â€“77. <a href="https://doi.org/10.2105/ajph.93.9.1376-a" class="external-link uri">https://doi.org/10.2105/ajph.93.9.1376-a</a>.
</div>
<div id="ref-Dunlap1998Interpretations" class="csl-entry">
Dunlap, W., and R. Landis. 1998. â€œInterpretations of Multiple Regression Borrowed from Factor Analysis and Canonical Correlation.â€ <em>Journal of General Psychology</em> 125: 397â€“407. <a href="https://doi.org/10.1080/00221309809595345" class="external-link uri">https://doi.org/10.1080/00221309809595345</a>.
</div>
<div id="ref-Hastie2015" class="csl-entry">
Hastie, Trevor, Robert Tibshirani, and Martin Wainwright. 2015. <em>Statistical Learning with Sparsity: The Lasso and Generalizations</em>. Chapman &amp; Hall/CRC. <a href="https://www.ime.unicamp.br/~dias/SLS.pdf" class="external-link uri">https://www.ime.unicamp.br/~dias/SLS.pdf</a>.
</div>
<div id="ref-McCabe2021" class="csl-entry">
McCabe, Connor J., M. Halvorson, K. King, Xiaolin Cao, and Dale S Kim. 2021. â€œInterpreting Interaction Effects in Generalized Linear Models of Nonlinear Probabilities and Counts.â€ <em>Multivariate Behavioral Research</em> 57: 243â€“63. <a href="https://doi.org/10.1080/00273171.2020.1868966" class="external-link uri">https://doi.org/10.1080/00273171.2020.1868966</a>.
</div>
<div id="ref-mccullagh1989" class="csl-entry">
McCullagh, P., and J. A. Nelder. 1989. <em>Generalized Linear Models, Second Edition</em>. Chapman and Hall/CRC Monographs on Statistics and Applied Probability Series. Chapman &amp; Hall. <a href="https://www.utstat.toronto.edu/~brunner/oldclass/2201s11/readings/glmbook.pdf" class="external-link uri">https://www.utstat.toronto.edu/~brunner/oldclass/2201s11/readings/glmbook.pdf</a>.
</div>
<div id="ref-PSUStat505Bivariate" class="csl-entry">
Pennsylvania State University. 2024. â€œBivariate Normal Distribution.â€ <a href="https://online.stat.psu.edu/stat505/lesson/4/4.2" class="external-link uri">https://online.stat.psu.edu/stat505/lesson/4/4.2</a>.
</div>
<div id="ref-Thompson1998" class="csl-entry">
Thompson, B. 1999. â€œFive Methodology Errors in Educational Research:apantheon of Statistical Significance and Other Faux Pas.â€ <em>Advances in Social Science Methodology</em> 5: 23â€“86. <a href="https://files.eric.ed.gov/fulltext/ED419023.pdf" class="external-link uri">https://files.eric.ed.gov/fulltext/ED419023.pdf</a>.
</div>
<div id="ref-Wilkinson1999Statistical" class="csl-entry">
Wilkinson, Leland. 1999. â€œStatistical Methods in Psychology Journals: Guidelines and Explanations.â€ <em>American Psychologist</em> 54: 594â€“604. <a href="https://doi.org/10.1037/0003-066X.54.8.594" class="external-link uri">https://doi.org/10.1037/0003-066X.54.8.594</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing RegrCoeffsExplorer</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Vadim Tyuryaev <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0008-1361-6265" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Aleksandr Tsybakin <br><small class="roles"> Author </small>  </li>
<li>Jane Heffernan <br><small class="roles"> Author </small>  </li>
<li>Hanna Jankowski <br><small class="roles"> Author </small>  </li>
<li>Kevin McGregor <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vadim Tyuryaev, Aleksandr Tsybakin, Jane Heffernan, Hanna Jankowski, Kevin McGregor.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
